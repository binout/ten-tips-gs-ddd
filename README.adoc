= 10 conseils pour réussir ses premiers pas en DDD
:icons: font
:deckjs_theme: swiss
:deckjs_transition: fade
:navigation: true
:goto: true
:status: true

:src: src/main/java

image::images/jugsummercamp.png[float="right"]

== Me

image::images/avatar.png[float="right"]

icon:twitter[] @binout +
icon:github[] https://github.com/binout

* Développeur Java depuis plus de 10 ans

image::images/bordeauxjug.png[float="right"]

* Membre du Bordeaux JUG

image::images/asciidoctor.png[float="right"]

* Commiteur Asciidoctor

image::images/lectra.png[float="right"]

* Technical Leader chez Lectra,
numéro un mondial des solutions dédiées à l'industrie du textile (machines et logiciels)

== Domain Driven Design

[quote, Eric Evans, 2003]
Tackling Complexity in the Heart of Software

image::images/blue-book.png[]

== Pourquoi DDD ?

* Existe-il une solution générique pour des problèmes métiers spécifiques ?

* Notre but :
** réduire la complexité accidentelle pour se concentrer sur la complexité métier
** comprendre le domain métier
** mieux communiquer avec les différents intervenants

== Conseil 1

image::images/DDDViteFait.png[float=right]

[quote]
1) Lire Domain-Driven Design Vite fait


https://www.infoq.com/fr/minibooks/domain-driven-design-quickly

== Conseil 2

[quote]
2) Mettre le focus sur la modélisation du métier

* Permet de définir un vocabulaire (`Ubiquitous Language`)
* Bien réfléchir aux propriétés des entités
* Bien définir des agrégats
* Rester indépendant de tous composants techniques (persistence, sérialisation)

== Exemple : Pokemon

image::images/pikachu.png[float=right]

Un Pokemon :

* A un type (`pikachu`)
* A un nom (par défaut type)
* A des PV (par défaut 100)
* Peut être nommé
* Peut évolué
* Peut mourrir ...

== POJO : ce n'est pas un modèle !

[source,java]
----
include::{src}/domain/bad/Pokemon.java[tags=pojo]
----

== Constructeur et propriété

[source,java]
----
include::{src}/domain/Pokemon.java[tags=new]
----

== Métier dans le modèle

[source,java]
----
include::{src}/domain/Pokemon.java[tags=business]
----

== Conseil 3

image::images/twitter-ouarzy.png[]


* Commencer par une persistence en mémoire (hashmap) pour éviter de lier son domaine
à des problèmatiques techniques

* Utiliser des UUIDs générés par l'application comme id

== Exemple : Interface Repository

[source,java]
----
include::{src}/domain/PokemonBox.java[]
----

== Exemple : InMemory Repository

[source,java]
----
include::{src}/infrastructure/persistence/InMemoryPokemonBox.java[tags=db]
----

== Conseil 4

[quote]
4) S'appuyer sur une architecture hexagonale

image::images/hexagonal.png[float=right]

* domain
* application
* interface
* infrastructure

== Conseil 5

[quote]
5) La couche application doit définir des cas d'utilisation

* un cas d'utilisation -> une classe avec une seule méthode
* pas d'appel entre deux services d'application
* permet d'écrire des tests indépendamment du protocol de l'interface

== Exemple : Evolution Pokemon

[source,java]
----
include::{src}/application/EvolvePokemon.java[tags=evolve]
----

== Exemple : Catch Pokemon

[source,java]
----
include::{src}/application/CatchPokemon.java[tags=catch]
----

== Conseil 6

[quote]
6) Bien comprendre la notion de service du domaine

* C'est un service dans la couche `domain`
* Introduire domain service quand une règle métier est partagé par deux services d'application

== Conseil 7

[quote]
7) Living Documentation FTW !

* Annotations :
** @DDD.Entity,  @DDD.Repository, @DDD.DomainService

* Générer un diagramme du domain à partir des sources

* Générer un diagramme des dépendances de l'architecture hexagonale


== Conseil 8

[quote]
8) Dépasser ses à-priori de développeur !

* Des habitudes de développement liées à notre apprentissage des frameworks...
* Le plus important c'est le métier pas la technique !

== Exemples

* Injection par constructeur vs Injection par champ

* Mapping JPA par annotations _pollue_ le domaine
** Utilisation de `orm.xml`
** pas de problème particulier
** support de l'ide
** plus d'annotations dans notre domaine !


== Conseil 9

[quote]
9) Faire des tests d'intégration en utilisant le BDD

* Permet de manipuler le domaine dans les tests (fichier _feature_)

== Conseil 10

[quote]
9) Impliquer son Product Owner

* Lui expliquer les concepts, la démarche
* Lui montrer le modèle
* Lui demander si le vocabulaire lui parle
* Lui montrer les tests BDD
* Lui demander de les écrire ;-)

== Conclusion : Not a silver bullet but ...

image::images/twitter-ouarzy2.png[]

* Permet de passer une étape dans votre parcours de développeur !
